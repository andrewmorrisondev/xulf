import { useContext, useState, ReactNode } from 'react';
import styled from '@emotion/styled';
import Switch from '@mui/joy/Switch';
import { ThemeContext } from '../theme/theme-context';

interface FloatingNavBarProps {
  children?: ReactNode;
}

const StyledFloatingNavBar = styled.div`
  max-width: 85em;
  height: auto;
  min-height: 5.5em;
  margin: 0 auto;
  border-radius: 4px;
  background: var(--background, #daebe4);
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 1rem;
  position: relative;

  z-index: 10;
`;

const StyledDiv = styled.div`
  display: flex;
  align-items: center;
  justify-content: center;
  flex-direction: column;
  gap: 0.5rem;
  padding: 1rem;
`;

const StyledLinks = styled.div`
  display: flex;
  flex-direction: row;
  gap: 1rem;

  h1 {
    font-size: 1rem;
    font-weight: 300;
  }

  @media (max-width: 768px) {
    display: none; // Hide children links by default on mobile
  }
`;

const StyledMobileLinks = styled.div`
  display: flex;
  flex-direction: column;
  gap: 1rem;

  h1 {
    font-size: 1rem;
    font-weight: 300;
  }
`;

const MobileMenu = styled.div<{ open: boolean }>`
  display: ${({ open }) => (open ? 'flex' : 'none')};
  position: absolute;
  top: 7em;
  right: 1rem;
  flex-direction: column;
  gap: 0.5rem;
  background-color: var(--background, #daebe4);
  border-radius: 0.5rem;
  padding: 1rem;
  box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);

  z-index: 9;

  @media (min-width: 769px) {
    display: none; // No dropdown on larger screens
  }
`;

const MenuButton = styled.div`
  display: none;
  cursor: pointer;

  @media (max-width: 768px) {
    display: block; // Show the menu button on mobile
  }
`;

export function FloatingNavBar({ children }: FloatingNavBarProps): JSX.Element {
  const { toggleTheme, mode } = useContext(ThemeContext);
  const [menuOpen, setMenuOpen] = useState(false);

  const toggleMenu = () => {
    setMenuOpen(!menuOpen);
  };

  return (
    <StyledFloatingNavBar>
      <svg width="234" height="89" viewBox="0 0 234 89" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M49.1113 50.2026C49.1113 48.903 48.4254 48.2532 47.0536 48.2532H44.8659V60.1012H47.0536C48.4254 60.1012 49.1113 59.437 49.1113 58.1085V50.2026ZM43.328 46.9103H47.1402C48.2954 46.9103 49.169 47.2063 49.7611 47.7984C50.3531 48.3904 50.6491 49.1846 50.6491 50.181V58.1518C50.6491 59.1771 50.3603 59.9857 49.7827 60.5778C49.2051 61.1698 48.3387 61.4658 47.1835 61.4658H43.328V46.9103ZM62.4938 46.9103H68.7968V48.2749H64.0316V53.4516H68.1903V54.8162H64.0316V60.1012H68.7968V61.4658H62.4938V46.9103ZM85.9182 46.9103H87.521L84.337 61.4658H82.171L78.987 46.9103H80.5682L82.106 54.1447C82.6548 57.0472 83.0374 58.9894 83.254 59.9713C83.3695 59.3937 83.5645 58.3973 83.8388 56.9822C84.1421 55.4371 84.8352 52.0798 85.9182 46.9103ZM98.3715 46.9103H104.675V48.2749H99.9094V53.4516H104.068V54.8162H99.9094V60.1012H104.675V61.4658H98.3715V46.9103ZM116.078 46.9103H117.616V60.1229H122.034V61.4658H116.078V46.9103ZM138.315 50.1593C138.315 48.7875 137.6 48.1016 136.17 48.1016C134.755 48.1016 134.048 48.7875 134.048 50.1593V58.2168C134.048 59.6031 134.755 60.2962 136.17 60.2962C137.6 60.2962 138.315 59.6031 138.315 58.2168V50.1593ZM132.51 50.1376C132.51 49.1124 132.82 48.2821 133.441 47.6467C134.062 47.0114 134.972 46.6937 136.17 46.6937C137.383 46.6937 138.3 47.0114 138.921 47.6467C139.542 48.2821 139.852 49.1124 139.852 50.1376V58.2601C139.852 59.2854 139.542 60.1157 138.921 60.751C138.3 61.372 137.383 61.6824 136.17 61.6824C134.957 61.6824 134.04 61.372 133.419 60.751C132.813 60.1157 132.51 59.2854 132.51 58.2601V50.1376ZM157.224 50.2676C157.224 48.9391 156.539 48.2749 155.167 48.2749H153.261V55.0978H155.167C156.539 55.0978 157.224 54.4408 157.224 53.1267V50.2676ZM151.723 46.9103H155.253C156.394 46.9103 157.261 47.2063 157.853 47.7984C158.459 48.3904 158.762 49.1846 158.762 50.181V53.1917C158.762 54.2025 158.466 55.0039 157.874 55.596C157.282 56.1736 156.409 56.4624 155.253 56.4624H153.261V61.4658H151.723V46.9103ZM170.339 46.9103H176.642V48.2749H171.876V53.4516H176.035V54.8162H171.876V60.1012H176.642V61.4658H170.339V46.9103ZM191.727 55.6176H189.583V61.4658H188.045V46.9103H191.575C192.731 46.9103 193.604 47.2063 194.196 47.7984C194.788 48.376 195.084 49.1702 195.084 50.181V52.3253C195.084 53.8848 194.463 54.8956 193.221 55.3577L195.539 61.4658H193.85L191.727 55.6176ZM189.583 54.2747H191.51C192.868 54.2747 193.546 53.6177 193.546 52.3036V50.2459C193.546 48.9319 192.868 48.2749 191.51 48.2749H189.583V54.2747ZM206.153 49.8561C206.153 48.903 206.471 48.1594 207.106 47.6251C207.742 47.0764 208.63 46.802 209.77 46.802C210.926 46.802 211.9 46.9247 212.695 47.1702V48.6431C211.944 48.3687 211.027 48.2316 209.944 48.2316C208.456 48.2316 207.713 48.7947 207.713 49.921V50.9607C207.713 51.4661 207.807 51.8632 207.994 52.152C208.196 52.4408 208.529 52.7152 208.991 52.9751L211.503 54.383C212.673 55.0184 213.258 55.9786 213.258 57.2638V58.4334C213.258 59.4298 212.918 60.2023 212.24 60.751C211.561 61.2998 210.579 61.5741 209.294 61.5741C208.023 61.5741 207.012 61.4297 206.262 61.1409V59.668C207.113 59.9857 208.081 60.1446 209.164 60.1446C210.868 60.1446 211.72 59.5453 211.72 58.3468V57.4371C211.72 56.9605 211.633 56.5851 211.46 56.3107C211.287 56.0364 210.976 55.7765 210.529 55.531L208.038 54.1664C206.781 53.4877 206.153 52.4769 206.153 51.134V49.8561Z" fill="var(--text)"/>
        <path d="M56.1262 41.6561H55.3051L48.9494 26.2686C48.5845 25.4171 48.2906 24.667 48.0675 24.0183L47.7634 26.3294L45.2698 42.7812H43.7797L47.3681 20.8556H48.2196L55.001 36.9729C55.3457 37.7231 55.6194 38.4326 55.8221 39.1016C55.8829 38.8786 56.1972 38.1792 56.7648 37.0033L64.3369 20.8556H65.158L68.4727 42.7812H66.9522L64.5802 26.2686C64.418 25.2347 64.3369 24.4542 64.3369 23.927C64.3166 23.9473 64.2659 24.0487 64.1848 24.2311C64.124 24.3933 64.0024 24.6772 63.8199 25.0826C63.6577 25.4678 63.4854 25.8733 63.303 26.299L56.1262 41.6561ZM76.1795 39.8923C74.1724 37.7231 73.1689 35.0571 73.1689 31.8945C73.1689 28.7318 74.1724 26.076 76.1795 23.927C78.2068 21.7578 80.7612 20.6732 83.8428 20.6732C86.9243 20.6732 89.4788 21.7578 91.5061 23.927C93.5334 26.076 94.5471 28.7318 94.5471 31.8945C94.5471 35.0571 93.5334 37.7231 91.5061 39.8923C89.4788 42.0615 86.9243 43.1462 83.8428 43.1462C80.7612 43.1462 78.2068 42.0615 76.1795 39.8923ZM77.2742 24.8698C75.5915 26.7552 74.7502 29.0967 74.7502 31.8945C74.7502 34.6922 75.5915 37.0439 77.2742 38.9496C78.9772 40.8553 81.1667 41.8081 83.8428 41.8081C86.5391 41.8081 88.7286 40.8553 90.4113 38.9496C92.1143 37.0439 92.9658 34.6922 92.9658 31.8945C92.9658 29.0967 92.1143 26.7552 90.4113 24.8698C88.7286 22.9641 86.5391 22.0112 83.8428 22.0112C81.1464 22.0112 78.9569 22.9641 77.2742 24.8698ZM101.292 42.7812V21.1293C103.218 20.9874 104.83 20.9165 106.128 20.9165C108.195 20.9165 109.898 21.4537 111.236 22.5282C112.575 23.5824 113.244 25.0826 113.244 27.0289C113.244 28.3466 112.858 29.5732 112.088 30.7085C111.318 31.8438 110.456 32.7459 109.503 33.415C110.253 34.4489 111.176 35.6856 112.27 37.125C113.385 38.5441 114.105 39.4361 114.43 39.8011C115.666 41.1188 117.065 41.869 118.626 42.0514L118.596 43.0245C117.359 43.0043 116.355 42.8218 115.585 42.4771C114.815 42.1122 114.075 41.5648 113.365 40.835C112.676 40.1052 110.943 37.8346 108.165 34.0232C106.178 34.0232 104.374 33.9623 102.752 33.8407V42.7812H101.292ZM107.283 32.8068C108.175 32.8068 109.128 32.2188 110.142 31.043C111.155 29.8671 111.662 28.5088 111.662 26.968C111.662 25.407 111.135 24.2311 110.081 23.4405C109.047 22.6296 107.668 22.2241 105.945 22.2241C105.033 22.2241 103.968 22.2646 102.752 22.3457V32.6547C104.374 32.7561 105.884 32.8068 107.283 32.8068ZM121.308 42.7812V21.1293C123.234 20.9874 124.846 20.9165 126.144 20.9165C128.211 20.9165 129.914 21.4537 131.252 22.5282C132.59 23.5824 133.26 25.0826 133.26 27.0289C133.26 28.3466 132.874 29.5732 132.104 30.7085C131.334 31.8438 130.472 32.7459 129.519 33.415C130.269 34.4489 131.192 35.6856 132.286 37.125C133.401 38.5441 134.121 39.4361 134.445 39.8011C135.682 41.1188 137.081 41.869 138.642 42.0514L138.612 43.0245C137.375 43.0043 136.371 42.8218 135.601 42.4771C134.831 42.1122 134.091 41.5648 133.381 40.835C132.692 40.1052 130.958 37.8346 128.181 34.0232C126.194 34.0232 124.39 33.9623 122.768 33.8407V42.7812H121.308ZM127.299 32.8068C128.191 32.8068 129.144 32.2188 130.158 31.043C131.171 29.8671 131.678 28.5088 131.678 26.968C131.678 25.407 131.151 24.2311 130.097 23.4405C129.063 22.6296 127.684 22.2241 125.961 22.2241C125.049 22.2241 123.984 22.2646 122.768 22.3457V32.6547C124.39 32.7561 125.9 32.8068 127.299 32.8068ZM141.324 42.7812V21.0381H142.784V42.7812H141.324ZM160.194 22.9539C158.714 22.3255 157.245 22.0112 155.785 22.0112C152.825 22.0112 151.345 23.106 151.345 25.2955C151.345 26.2483 151.68 27.1404 152.349 27.9716C153.018 28.7825 153.829 29.5124 154.781 30.1611C155.734 30.7896 156.687 31.4383 157.64 32.1073C158.593 32.7764 159.404 33.5772 160.073 34.5097C160.742 35.4423 161.076 36.456 161.076 37.5507C161.076 39.3956 160.458 40.7945 159.221 41.7473C157.985 42.6799 156.272 43.1462 154.082 43.1462C151.913 43.1462 150.058 42.5887 148.517 41.4736L149.247 40.3789C150.707 41.3317 152.308 41.8081 154.052 41.8081C155.795 41.8081 157.133 41.4635 158.066 40.7742C158.998 40.0646 159.465 39.051 159.465 37.7332C159.465 36.8209 159.13 35.9593 158.461 35.1483C157.792 34.3171 156.981 33.5772 156.028 32.9284C155.075 32.2594 154.123 31.5802 153.17 30.8909C152.217 30.2016 151.406 29.3806 150.737 28.4277C150.068 27.4749 149.733 26.4511 149.733 25.3563C149.733 23.9169 150.261 22.7816 151.315 21.9504C152.389 21.0989 153.829 20.6732 155.633 20.6732C157.458 20.6732 159.15 21.0381 160.711 21.7679L160.194 22.9539ZM169.162 39.8923C167.155 37.7231 166.151 35.0571 166.151 31.8945C166.151 28.7318 167.155 26.076 169.162 23.927C171.189 21.7578 173.743 20.6732 176.825 20.6732C179.906 20.6732 182.461 21.7578 184.488 23.927C186.516 26.076 187.529 28.7318 187.529 31.8945C187.529 35.0571 186.516 37.7231 184.488 39.8923C182.461 42.0615 179.906 43.1462 176.825 43.1462C173.743 43.1462 171.189 42.0615 169.162 39.8923ZM170.256 24.8698C168.574 26.7552 167.732 29.0967 167.732 31.8945C167.732 34.6922 168.574 37.0439 170.256 38.9496C171.959 40.8553 174.149 41.8081 176.825 41.8081C179.521 41.8081 181.711 40.8553 183.393 38.9496C185.096 37.0439 185.948 34.6922 185.948 31.8945C185.948 29.0967 185.096 26.7552 183.393 24.8698C181.711 22.9641 179.521 22.0112 176.825 22.0112C174.129 22.0112 171.939 22.9641 170.256 24.8698ZM195.673 24.5048L195.734 27.0897V42.7812H194.275V20.8556H194.944L209.267 37.3683C210.24 38.5238 210.99 39.4463 211.517 40.1356C211.436 39.1625 211.395 38.0474 211.395 36.7905V21.0381H212.855V42.9637H212.186L197.589 26.147C196.576 24.9914 195.927 24.221 195.643 23.8358L195.673 24.5048Z" fill="var(--text)"/>
        <path d="M0.672363 61.4656V34.2283L17.4928 40.9426V61.4656H13.8295V27.8095L29.2568 31.9901V61.4656H24.4068V25.5714L36.9963 16.999V61.4656" stroke="var(--text)"/>
      </svg>
      {/* Desktop Links */}
      <StyledLinks>{children}</StyledLinks>

      {/* Mobile Menu Button */}
      <MenuButton onClick={toggleMenu}>
      <svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M2.63574 6C2.63574 5.44772 3.08346 5 3.63574 5H21.6357C22.188 5 22.6357 5.44772 22.6357 6C22.6357 6.55228 22.188 7 21.6357 7H3.63574C3.08346 7 2.63574 6.55228 2.63574 6Z" fill="var(--text)"/>
        <path d="M2.63574 12.0322C2.63574 11.4799 3.08346 11.0322 3.63574 11.0322H21.6357C22.188 11.0322 22.6357 11.4799 22.6357 12.0322C22.6357 12.5845 22.188 13.0322 21.6357 13.0322H3.63574C3.08346 13.0322 2.63574 12.5845 2.63574 12.0322Z" fill="var(--text)"/>
        <path d="M3.63574 17.0645C3.08346 17.0645 2.63574 17.5122 2.63574 18.0645C2.63574 18.6167 3.08346 19.0645 3.63574 19.0645H21.6357C22.188 19.0645 22.6357 18.6167 22.6357 18.0645C22.6357 17.5122 22.188 17.0645 21.6357 17.0645H3.63574Z" fill="var(--text)"/>
      </svg>
      </MenuButton>

      {/* Mobile Dropdown Menu */}
      <MobileMenu open={menuOpen}>
        <StyledMobileLinks>{children}</StyledMobileLinks>
      </MobileMenu>

      {/* Theme Switch */}
      <StyledDiv>
        {mode === 'dark' ? (
          <svg width="27" height="27" viewBox="0 0 27 27" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path
              d="M22.9731 17.7538L26.7797 13.9472L22.9731 10.1406V4.74701H17.5795L13.7729 0.94043L9.96631 4.74701H4.5727V10.1406L0.766113 13.9472L4.5727 17.7538V23.1474H9.96631L13.7729 26.954L17.5795 23.1474H22.9731V17.7538ZM13.7729 20.8474C9.96631 20.8474 6.87274 17.7538 6.87274 13.9472C6.87274 10.1406 9.96631 7.04706 13.7729 7.04706C17.5795 7.04706 20.673 10.1406 20.673 13.9472C20.673 17.7538 17.5795 20.8474 13.7729 20.8474Z"
              fill="var(--text)"
            />
          </svg>
        ) : (
          <svg width="18" height="24" viewBox="0 0 18 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path
              d="M6.17172 2.59896C11.3253 2.59896 15.5207 6.79432 15.5207 11.9479C15.5207 17.1016 11.3253 21.2969 6.17172 21.2969C5.77439 21.2969 5.37706 21.2735 4.99142 21.2151C7.22348 18.6909 8.50897 15.3954 8.50897 11.9479C8.50897 8.50051 7.22348 5.20499 4.99142 2.68077C5.37706 2.62234 5.77439 2.59896 6.17172 2.59896ZM6.17172 0.261719C4.04483 0.261719 2.04649 0.84603 0.328613 1.83936C3.82279 3.86108 6.17172 7.62404 6.17172 11.9479C6.17172 16.2718 3.82279 20.0348 0.328613 22.0565C2.04649 23.0499 4.04483 23.6342 6.17172 23.6342C12.6225 23.6342 17.8579 18.3987 17.8579 11.9479C17.8579 5.49715 12.6225 0.261719 6.17172 0.261719Z"
              fill="var(--text)"
            />
          </svg>
        )}
        <Switch
          checked={mode === 'dark'}
          onChange={toggleTheme}
          slotProps={{
            thumb: {
              style: {
                backgroundColor: 'var(--background)', // Customize thumb color
              },
            },
            track: {
              style: {
                backgroundColor: 'var(--text)', // Customize track color
              },
            },
            input: {
              'aria-label': 'Theme Switch',
            },
          }}
        />
      </StyledDiv>
    </StyledFloatingNavBar>
  );
}

export default FloatingNavBar;
